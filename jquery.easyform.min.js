/*

EasyForm - | 2015-01-16
A easy custom simple contact form jQuery plugin

Author: Giuliano Stedile


*/
(function(e){e.fn.easyform=function(t){function s(t){if(e('select[name="estado"]',t).length){var n=e('select[name="estado"]',t).val()}else{var n=""}if(e('select[name="nivel"]',t).length){var s=e('select[name="nivel"]',t).val()}else{var s=""}var o={token:r.token,secret:r.secret,lead:{name:e('input[name="nome"]',t).val(),email:e('input[name="email"]',t).val(),estado:n,nivel:s}};e.ajax({type:"POST",url:r.urlRequest,data:o,contentType:"application/x-www-form-urlencoded; charset=UTF-8",success:function(n){console.log("HTTP Status 200: Sucesso!");t.get(0).reset();e(".ef-alertas",t).html('<div class="alert alert-success alert-dismissible" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button> '+i.txtSuccess+" </div>")},error:function(n,r,s){if(n.status==500){console.log("HTTP Status 500: Erro!");e(".ef-alertas",t).html('<div class="alert alert-danger alert-dismissible" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button> '+i.txtError500+" </div>")}else{console.log("HTTP Status "+n.status+": Outro erro!");e(".ef-alertas",t).html('<div class="alert alert-danger alert-dismissible" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button> '+i.txtOtherError+" </div>")}}});return true}function o(t){e('input[name="nome"], input[name="email"]',t).parent().removeClass("has-error");var n=e('input[name="nome"]',t).val();if(n==""){e('input[name="nome"]',t).parent().addClass("has-error");e('input[name="nome"]',t).focus();return false}var r=e('input[name="email"]',t).val();if(r==""||!a(r)){e('input[name="email"]',t).parent().addClass("has-error");e('input[name="email"]',t).focus();return false}return true}function u(){var e='<form class="ef-form" id="formulario-ef"> <fieldset class="ef-fieldset">';e+='<legend class="ef-legend-fieldset">'+r.title+"</legend>";e+='<div class="form-group"> <label class="ef-label-campo" for="ef-inputNome">'+i.titleCampoNome+' *</label> <input id="ef-inputNome" class="form-control ef-input-nome" type="text" name="nome" placeholder="'+i.phCampoNome+'" autofocus> </div>';e+='<div class="form-group"> <label class="ef-label-campo" for="ef-inputEmail">'+i.titleCampoEmail+' *</label> <input id="ef-inputEmail" class="form-control ef-input-email" type="email" name="email" placeholder="'+i.phCampoEmail+'"> </div>';e+='<div class="row">';if(r.fields.estado||r.fields.estado!=""){e+='<div class="col-xs-3"> <label class="ef-label-campo" for="ef-selectStates">'+i.titleSelectEstado+'</label> <select class="form-control ef-select-estados" id="ef-selectStates" name="estado">';var t=r.fields.estado;for(var n in t){e+='<option value="'+t[n]+'">'+t[n]+"</option>"}e+="</select> </div>"}if(r.fields.nivel||r.fields.nivel!=""){e+='<div class="col-xs-4"> <label class="ef-label-campo" for="ef-selectLevels">'+i.titleSelectNivel+'</label> <select class="form-control ef-select-niveis" id="ef-selectLevels" name="nivel">';var s=r.fields.nivel;for(var n in s){e+='<option value="'+s[n]+'">'+s[n]+"</option>"}e+="</select> </div>"}e+='<div class="col-xs-3 pull-right"> <button type="submit" class="btn btn-success pull-right ef-btn-submit clearfix">'+i.nBtnSubmit+"</button>  </div>";e+='</div> <div class="form-group"> <span id="helpBlock" class="help-block ef-dica">'+i.txtDica+"</span> </div>";e+='</fieldset> <div class="ef-alertas"></div> </form>';return e}function a(e){var t=new RegExp(/^[A-Za-z0-9_\-\.]+@[A-Za-z0-9_\-\.]{2,}\.[A-Za-z0-9]{2,}(\.[A-Za-z0-9])?/);if(typeof e=="string"){if(t.test(e)){return true}}else if(typeof e=="object"){if(t.test(e.value)){return true}}else{return false}}var n={token:"",secret:"",lang:"pt",modal:false,nameButtonModal:"Press to open form",urlRequest:"http://teste.com.br",title:"Form",fields:{estado:"",nivel:""}};var r=e.extend({},n,t);var i={};switch(r.lang){case"en":i.titleCampoNome="Name:";i.phCampoNome="Type your full name...";i.titleCampoEmail="E-mail:";i.phCampoEmail="Ex.: antonio@hotmail.com";i.titleSelectEstado="State:";i.titleSelectNivel="Level:";i.nBtnSubmit="Submit";i.nBtnSubmitLoading="Sending...";i.txtSuccess="Form submitted successfully!";i.txtError500="Failed to send form! Error HTTP 500";i.txtOtherError="Failed to send form! Other HTTP error";i.txtDica="* Required fields.";break;case"pt":i.titleCampoNome="Nome:";i.phCampoNome="Digite seu nome completo...";i.titleCampoEmail="E-mail:";i.phCampoEmail="Ex.: antonio@hotmail.com";i.titleSelectEstado="Estado:";i.titleSelectNivel="Nível:";i.nCampoNome="Name:";i.nBtnSubmit="Enviar";i.nBtnSubmitLoading="Enviando...";i.txtSuccess="Formulário enviado con sucesso!";i.txtError500="Falha ao enviar formulário! Erro HTTP 500";i.txtOtherError="Falha ao enviar formulário! Outro erro HTTP";i.txtDica="* Campos obrigatórios.";break}return this.each(function(){if(!r.token||r.token==""){e(this).html('<div class="alert alert-danger alert-dismissible" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Error ef-0001: Token unspecified.</div>');return false}if(!r.secret||r.secret==""){e(this).html('<div class="alert alert-danger alert-dismissible" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Error ef-0002: Secret unspecified.</div>');return false}if(!r.urlRequest||r.urlRequest==""){e(this).html('<div class="alert alert-danger alert-dismissible" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Error ef-0003: urlRequest unspecified.</div>');return false}if(r.modal==true){e("#integration_form").replaceWith('<a href="#ef-modal" id="integration_form" role="button" class="btn btn-primary" data-toggle="modal">'+r.nameButtonModal+'</a> <div class="modal fade" id="ef-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">'+r.title+'</h4> </div> <div class="modal-body">'+u()+"</div> </div> </div> </div>");e("#ef-modal").on("show.bs.modal",function(t){var n=e(this);var r=e("form#formulario-ef",n);e("legend",r).remove();r.submit(function(t){t.preventDefault();if(o(r)){e('button[type="submit"]',r).html(i.nBtnSubmitLoading).attr("disabled",true);if(s(r)){e('button[type="submit"]',r).html(i.nBtnSubmit).removeAttr("disabled")}}})})}else{e(this).html(u());var t=e("form#formulario-ef");t.submit(function(n){n.preventDefault();if(o(t)){e('button[type="submit"]',t).html(i.nBtnSubmitLoading).attr("disabled",true);if(s(t)){e('button[type="submit"]',t).html(i.nBtnSubmit).removeAttr("disabled")}}})}})}})(jQuery)